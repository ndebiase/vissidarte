var SES={xscroll:0,headerwidth:56,ajp:{url:"ajaxvissi.aspx",type:"POST",dataType:"text"},logo:"img/logoVissi.png",campitab:{"0":["INFO1","INFO2","INFO3"]},campinote:{"0":["NOTE"],"1":["NOTE"],"10":["NOTE"],"20":["NOTE"],"30":["NOTE"]},campiinfo:{"0":["LIBERO","TELEFONI","INDIRIZZO","LIBERO","ABILITAZIONI","LIBERO"],"1":["LIBERO","TELEFONI","INDIRIZZO","LIBERO","ABILITAZIONI","LIBERO"],"10":["LIBERO","TELEFONI","INDIRIZZO","LIBERO","ABILITAZIONI","LIBERO"],"20":["LIBERO","TELEFONI","INDIRIZZO","LIBERO","ABILITAZIONI","LIBERO"],"30":["LIBERO","TELEFONI","INDIRIZZO","LIBERO","ABILITAZIONI","LIBERO"]},cfg:{hidden:" pwd ",readonly:" id lastaccess info note ",t10:" news ",t20:" utenti tabelle "}};function setWait(){$("body").css("cursor","progress")}function resetWait(){$("body").css("cursor","default")}function setajp(a){SES.ajp.data=a}function setError(a){if(a.err!=null){myalert(a.err)}else{myalert("connection error: "+a.status+" - "+a.readyState)}}$(window).load(function(){$(window).scroll(myscroll);$("#myModal").on("shown.bs.modal",function(){$("#login").focus()});$("#myModal").on("show.bs.modal",function(){initLogin(SES.utente)})});function myscroll(c){var a=$(window).scrollTop(),d=$(window).height(),b=$(window).width();if(a>0&&SES.xscroll==0){$("#logo").animate({height:SES.headerwidth});$("#motto").animate({top:(b>767)?200:50})}if(a==0&&SES.xscroll>0){$("#motto").animate({top:50})}SES.xscroll=a}function headerTransparent(){if($(window).width()>1200){$(".navbar-default").css("background-color","rgba(0,0,0,0)");$(".navbar-default").css("border","0px")}}function scrollto(b){var a=$(b);$("html,body").animate({scrollTop:a.offset().top-SES.headerwidth},"slow")}function showDetails(a){myalert("show detail N."+a)}function myalert(a){$("#msg").text(a);$("#myMsg").modal()}function bnews(tipo,noscroll,tag){var k,j,qq,ret,src,htm,txt,lista=$("#news"),limit=50;if(tipo==null){src=$("#news-search-input").val();tipo=-1}else{if(tag!=null){src=SES.tags[tag]}}setajp({op:0,news:tipo,src:src});$.ajax(SES.ajp).complete(function(data){if(data.status==200&&data.readyState==4){ret=eval(data.responseText);if(ret.err!=null){myalert(ret.err)}else{SES.online=ret.online;SES.title=ret.title;initLogin(ret.utente);SES.news=ret.lista;htm="";src="";for(k=0;k<SES.news.length;k++){if(SES.news[k].sez!=src){src=SES.news[k].sez;htm+="<div class='col-lg-12 col-md-12 col-sm-12 myitem tema0'><h1 class='page-header'>"+src+"</h1></div>"}flagdata=(SES.news[k].th.toLowerCase().indexOf("data")>=0)?true:false;href="javascript:showDetails("+k+")";htm+="<div class='"+setlargclass(SES.news[k].ll,SES.news[k].th)+"'><div class='media'>";if(SES.news[k].img!=""&&SES.news[k].img!=null){htm+="<div>";if(href!=""){htm+="<a href='"+href+"'>"}htm+="<img class='myimg' src='"+SES.news[k].img+"' title='"+SES.news[k].tit+"' />";if(href!=""){htm+="</a>"}htm+="</div>"}htm+="</div></div>"}lista.empty();lista.append(htm);if(noscroll==null){scrollto("#areanews")}$(".collapse").collapse("hide");setTimeout(function(){$(".mygrid").masonry("destroy");$(".mygrid").masonry({itemSelector:".myitem",columnWidth:60})},2000)}}else{setError(data)}})}function settitolo(b){var a;if(b.indexOf("<")>=0){a=b}else{a="<h3 class='media-heading'>"+b+"</h3>"}return a}function setlargclass(a,c){var b;if(a==1){b="myitem col-lg-1 col-md-1 col-sm-1 col-xs-3"}else{if(a==2){b="myitem col-lg-2 col-md-2 col-sm-3 col-xs-4"}else{if(a==3){b="myitem col-lg-3 col-md-3 col-sm-5 col-xs-12"}else{if(a==4){b="myitem col-lg-4 col-md-4 col-sm-5 col-xs-12"}else{if(a==5){b="myitem col-lg-5 col-md-5 col-sm-5 col-xs-12"}else{if(a==6){b="myitem col-lg-6 col-md-6 col-sm-12 col-xs-12"}else{if(a==7){b="myitem col-lg-7 col-md-7 col-sm-12 col-xs-12"}else{if(a==8){b="myitem col-lg-8 col-md-8 col-sm-12 col-xs-12"}else{if(a==9){b="myitem col-lg-9 col-md-9 col-sm-12 col-xs-12"}else{if(a==10){b="myitem col-lg-10 col-md-10 col-sm-12 col-xs-12"}else{if(a==11){b="myitem col-lg-11 col-md-11 col-sm-12 col-xs-12"}else{if(a==12){b="myitem col-lg-12 col-md-12 col-sm-12 col-xs-12"}else{b="myitem col-lg-3 col-md-3 col-sm-5 col-xs-12"}}}}}}}}}}}}return b+" "+c}function gopost(a){$.ajax({url:"ajaxreport.aspx",type:"POST",data:a}).complete(function(b){if(b.status==200&&b.readyState==4){var c=window.open("myReg","myReg");c.document.open();c.document.write(b.responseText);c.document.close()}})}function setContent(a,c){var b=$("#contenitore");if(c!=null){b=$(c)}b.empty();b.append(a);b.trigger("create")}function initLogin(a){if(a!=null){SES.utente=a;$(".siglaut").text(SES.utente.nome);$("#blogin,#bregister,#dochgpwd,#bforgotpwd,#bresetpwd").hide();$("#blogout,#bchgpwd,#bremaccount").show()}else{$(".siglaut").text("Login");$("#formlogin,#blogin,#bregister,#bforgotpwd").show();$("#blogout,#bchgpwd,#bremaccount,#bnewaccount,#bresetpwd,#dochgpwd,#formchgpwd,#formreg,#formforgot").hide()}$("#online").text(SES.online)}function portfolio(){var a;if(SES.utente!=null){htm="";htm+="<button type='button' class='btn btn-default btn-lg col-lg-2 col-md-2 col-sm-2 col-xs-5 myitem c3' onclick='javascript:bnews(-1)'>all</button> ";for(a=0;a<SES.tags.length;a++){htm+="<button type='button' class='btn btn-default btn-lg col-lg-2 col-md-2 col-sm-2 col-xs-5 myitem c3' onclick='javascript:bnews(-1,null,"+a+")'>"+SES.tags[a]+"</button> "}setContent(htm,"#mytags");scrollto("#areanews")}else{myalert("Not logged in or session expired.")}}function blogin(){var ret,op1=1,log=$("#login"),pwd=$("#pwd"),cons=$("#cons1");if(log.val()==""||pwd.val()==""||!cons.is(":checked")){myalert("Login and password are required. Check 'I agree' to proceed")}else{setWait();setajp({op:op1,a:log.val(),b:pwd.val()});$.ajax(SES.ajp).complete(function(data){if(data.status==200&&data.readyState==4){ret=eval(data.responseText);if(ret.err!=null){myalert(ret.err)}else{SES.utente=ret.utente;SES.tags=ret.tags;if(SES.utente!=null){initLogin(SES.utente);htm="<div class='btn-group btn-group-justified' role='group' aria-label='tags'>";for(k=0;k<SES.tags.length;k++){htm+="<button type='button' class='btn btn-default'>"+SES.tags[k]+"</button>"}htm+="</div>";setContent(htm,"#mytags")}else{myalert("invalid login or password")}log.val("");pwd.val("")}}else{setError(data)}resetWait()})}}function blogout(){SES.utente=null;$("#login").val("");$("#pwd").val("");initLogin();setajp({op:2});$.ajax(SES.ajp).complete(function(data){if(data.status==200&&data.readyState==4){ret=eval(data.responseText);if(ret.err!=null){myalert(ret.err)}}else{setError(data)}})}function remAccount(){if(confirm("Your account is going to be removed. Confirm ?")==true){SES.utente=null;$("#login").val("");$("#pwd").val("");initLogin();setajp({op:15});$.ajax(SES.ajp).complete(function(data){if(data.status==200&&data.readyState==4){ret=eval(data.responseText);if(ret.err!=null){myalert(ret.err)}else{myalert("Your account has been removed.")}}else{setError(data)}})}}function changepwd(){$("#formlogin,#bchgpwd,#bremaccount,#blogout").hide();$("#formchgpwd,#dochgpwd").show()}function resetpwd(){var ret,email=$("#email1").val();if(email==""){myalert("type the email that was used in Sign up.")}else{setWait();setajp({op:25,e:email});$.ajax(SES.ajp).complete(function(data){if(data.status==200&&data.readyState==4){ret=eval(data.responseText);if(ret.err!=null){myalert(ret.err)}else{myalert("A new password has been sent.")}}else{setError(data)}resetWait()})}}function dochangepwd(){var ret,oldpwd=$("#oldpwd"),newpwd1=$("#newpwd1"),newpwd2=$("#newpwd2");if(oldpwd.val()==""||newpwd1.val()==""||newpwd1.val()!=newpwd2.val()){myalert("type the old password and set new password = confirm new password")}else{setWait();setajp({op:3,b:oldpwd.val(),b2:newpwd1.val()});$.ajax(SES.ajp).complete(function(data){if(data.status==200&&data.readyState==4){ret=eval(data.responseText);if(ret.err!=null){myalert(ret.err)}else{oldpwd.val("");newpwd1.val("");newpwd2.val("");myalert("Password succesfully changed. Redo login.");blogout()}}else{setError(data)}resetWait()})}}function bregister(){$("#formlogin,#blogin,#bregister,#bforgotpwd").hide();$("#formreg,#bnewaccount").show()}function bnewaccount(){setWait();setajp({op:24,a:{no:$("#name").val(),co:$("#surname").val(),e:$("#email").val()}});$.ajax(SES.ajp).complete(function(data){var ret;if(data.status==200&&data.readyState==4){ret=eval(data.responseText);if(ret.err==null){myalert("The registration succeeded. Check the email to get your credentials.")}else{setError(ret)}}else{setError(data)}resetWait()})}function forgotpwd(){$("#formlogin,#blogin,#bregister,#bforgotpwd").hide();$("#formforgot,#bresetpwd").show()}function bremoveaccount(){setWait();setajp({op:24,a:{no:$("#name").val(),co:$("#surname").val(),e:$("#email").val()}});$.ajax(SES.ajp).complete(function(data){var ret;if(data.status==200&&data.readyState==4){ret=eval(data.responseText);if(ret.err==null){myalert("The account has been removed.")}else{setError(ret)}}else{setError(data)}resetWait()})};